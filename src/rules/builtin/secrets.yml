version: "1.0"
rules:
  - id: CLAWSEC-014
    name: api-key-exposure
    severity: critical
    category: secrets
    patterns:
      # Generic API keys
      - regex: "(api[_-]?key|apikey)\\s*[:=]\\s*['\"][a-zA-Z0-9_-]{20,}['\"]"
        flags: "i"
      # AWS keys
      - regex: "AKIA[0-9A-Z]{16}"
      # GitHub tokens
      - regex: "(ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9_]{36}"
      # Anthropic API key
      - regex: "sk-ant-[a-zA-Z0-9-]{90,}"
      # OpenAI API key
      - regex: "sk-[a-zA-Z0-9]{48}"
    perFileLimit: true
    message: "Potential API key or token exposed: '{match}'"
    remediation: "Remove hardcoded secrets. Use environment variables or secret management."
    metadata:
      owasp: "LLM06:2025"
      cwe: "CWE-798"

  - id: CLAWSEC-015
    name: private-key
    severity: critical
    category: secrets
    patterns:
      - regex: "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----"
      - regex: "-----BEGIN PGP PRIVATE KEY BLOCK-----"
    perFileLimit: true
    message: "Private key detected in skill content"
    remediation: "Never include private keys in skill files. Use secure key management."
    metadata:
      owasp: "LLM06:2025"
      cwe: "CWE-321"
